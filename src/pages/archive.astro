---
import CycleImage from "../components/CycleImage";
import Layout from "../layouts/Layout.astro";
import { getProjects } from "../lib/projects";

const projects = await getProjects();
---

<Layout title="Archive |">
  <section class="w-full max-w-7xl mx-auto bg-background text-palette-brightest-white py-36">
    <div class="container mx-auto">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-12 px-4">
        {projects.map((project) => (
          <a
            href={`/project/${project.slug}`}
            class="relative group max-w-2xl mx-auto w-full block"
          >
            <CycleImage
              client:load
              images={project.imageItems}
              startIndex={0}
              className="w-full h-auto select-none object-contain"
              disableClick={true}
            />
          </a>
        ))}
      </div>
    </div>
  </section>
</Layout>

<style>
	/* Prevent layout shift and improve image cycling */
	.cycle-image-container {
		contain: layout style paint;
		will-change: contents;
	}
	
	/* Smooth image transitions */
	img {
		transition: opacity 0.2s ease-in-out;
		will-change: contents;
	}
	
	/* Prevent scroll jumping and touch behaviors */
	img[tabindex] {
		user-select: none;
		-webkit-user-select: none;
		-moz-user-select: none;
		-ms-user-select: none;
		-webkit-touch-callout: none;
		-webkit-tap-highlight-color: transparent;
		touch-action: manipulation;
	}
	
	/* Prevent any layout shifting during image cycling */
	.cycle-image-container img {
		transform: translateZ(0); /* Force hardware acceleration */
		-webkit-backface-visibility: hidden;
		backface-visibility: hidden;
	}
	
	/* Ensure grid doesn't reflow */
	.grid {
		isolation: isolate;
	}
</style> 