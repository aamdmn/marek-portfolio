---
import CycleImage from "./CycleImage";
import { getProjects } from "../lib/projects";

const projects = await getProjects();
const previewProjects = projects.slice(0, 6);
---

	<div class="w-full max-w-7xl mx-auto bg-background text-palette-brightest-white py-4 sm:py-8 min-h-screen">
		<div class="container mx-auto px-4 sm:px-6">
			<div class="grid grid-cols-1 md:grid-cols-2 gap-8 sm:gap-16 md:gap-24 lg:gap-32 relative">
				{previewProjects.map((project) => (
					<a
						href={`/project/${project.slug}`}
						class="relative w-full block"
					>
						<CycleImage
							client:load
							images={project.imageItems}
							startIndex={0}
							disableClick={true}
						/>
					</a>
				))}
			</div>
	</div>
	<div class="flex justify-center px-4 pt-8 sm:pt-12 md:pt-16 lg:pt-20">
		<a href="/archive" class="text-sm sm:text-base font-mono text-palette-brightest-white hover:text-white hover:underline transition-colors duration-300">see_full_archive</a>
	</div>
</div>

<style>
	/* Prevent layout shift and improve image cycling */
	.cycle-image-container {
		contain: layout style paint;
		will-change: contents;
	}
	
	/* Smooth image transitions */
	img {
		transition: opacity 0.2s ease-in-out;
		will-change: contents;
	}
	
	/* Prevent scroll jumping and touch behaviors */
	img[tabindex] {
		user-select: none;
		-webkit-user-select: none;
		-moz-user-select: none;
		-ms-user-select: none;
		-webkit-touch-callout: none;
		-webkit-tap-highlight-color: transparent;
		touch-action: manipulation;
	}
	
	/* Prevent any layout shifting during image cycling */
	.cycle-image-container img {
		transform: translateZ(0); /* Force hardware acceleration */
		-webkit-backface-visibility: hidden;
		backface-visibility: hidden;
	}
	
	/* Ensure grid doesn't reflow */
	.grid {
		isolation: isolate;
	}
	
	/* Mobile-specific optimizations */
	@media (max-width: 768px) {
		.cycle-image-container {
			/* Reduce memory usage on mobile */
			contain: layout style;
		}
		
		/* Optimize touch interactions */
		img {
			touch-action: manipulation;
			-webkit-touch-callout: none;
			-webkit-tap-highlight-color: rgba(0, 0, 0, 0);
		}
		
		/* Ensure images don't overflow on small screens */
		.grid > div {
			max-width: 100%;
			overflow: hidden;
		}
	}
	
	/* Tablet and larger mobile optimizations */
	@media (min-width: 768px) and (max-width: 1024px) {
		.grid {
			/* Ensure consistent spacing on tablets */
			align-items: start;
		}
	}
</style>

